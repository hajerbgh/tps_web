<div class="card">
  <h2>{{ isEditMode ? 'Modifier un livre' : 'Ajouter un livre' }}</h2>

  <form #bookForm="ngForm" (ngSubmit)="onSubmit(bookForm)" novalidate>
    <!-- TITLE -->
    <div class="form-group">
      <label for="title">Titre</label>
      <input id="title" name="title" [(ngModel)]="bookModel.title" required minlength="3" pattern="^(?!\\d+$).+" #title="ngModel" />
      <div class="err" *ngIf="title.invalid && (title.dirty || title.touched)">
        <small *ngIf="title.errors?.['required']">Le titre est requis.</small>
        <small *ngIf="title.errors?.['minlength']">Min 3 caractères.</small>
        <small *ngIf="title.errors?.['pattern']">Le titre ne peut pas être uniquement des chiffres.</small>
      </div>
    </div>

    <!-- AUTHOR -->
    <div class="form-group">
      <label for="author">Auteur</label>
      <input id="author" name="author" [(ngModel)]="bookModel.author" required minlength="3" #author="ngModel" />
      <div class="err" *ngIf="author.invalid && (author.dirty || author.touched)">
        <small *ngIf="author.errors?.['required']">L'auteur est requis.</small>
      </div>
    </div>

    <!-- EMAIL -->
    <div class="form-group">
      <label for="publisherEmail">Email éditeur</label>
      <input id="publisherEmail" name="publisherEmail" type="email" [(ngModel)]="bookModel.publisherEmail" required #email="ngModel" />
      <div class="err" *ngIf="email.invalid && (email.dirty || email.touched)">
        <small *ngIf="email.errors?.['required']">Email requis.</small>
        <small *ngIf="email.errors?.['email']">Email invalide.</small>
      </div>
    </div>

    <!-- PHONE -->
    <div class="form-group">
      <label for="publisherPhone">Téléphone éditeur (8 chiffres)</label>
      <input id="publisherPhone" name="publisherPhone" [(ngModel)]="bookModel.publisherPhone" pattern="^[0-9]{8}$" #phone="ngModel" />
      <div class="err" *ngIf="phone.invalid && (phone.dirty || phone.touched)">
        <small *ngIf="phone.errors?.['pattern']">Doit contenir 8 chiffres (ex: 12345678).</small>
      </div>
    </div>

    <!-- RELEASE DATE -->
    <div class="form-group">
      <label for="releaseDate">Date de sortie</label>
      <input id="releaseDate" name="releaseDate" type="date" [(ngModel)]="bookModel.releaseDate" required min="1901-01-01" #rdate="ngModel" />
      <div class="err" *ngIf="rdate.invalid && (rdate.dirty || rdate.touched)">
        <small *ngIf="rdate.errors?.['required']">Date requise.</small>
      </div>
    </div>

    <!-- CATEGORY -->
    <div class="form-group">
      <label for="category">Catégorie</label>
      <select id="category" name="category" [(ngModel)]="bookModel.category" required #cat="ngModel">
        <option value="">--Choisir--</option>
        <option *ngFor="let c of categories" [value]="c">{{ c }}</option>
      </select>
      <div class="err" *ngIf="cat.invalid && (cat.dirty || cat.touched)">
        <small *ngIf="cat.errors?.['required']">Catégorie requise.</small>
      </div>
    </div>

    <!-- AVAILABLE -->
    <div class="form-group checkbox">
      <label><input id="isAvailable" name="isAvailable" type="checkbox" [(ngModel)]="bookModel.isAvailable" /> Disponible</label>
    </div>

    <!-- STOCK -->
    <div class="form-group">
      <label for="stock">Stock (facultatif)</label>
      <input id="stock" name="stock" type="number" min="0" [(ngModel)]="bookModel.stock" #stock="ngModel" />
      <div class="err" *ngIf="stock.invalid && (stock.dirty || stock.touched)">
        <small *ngIf="stock.errors?.['min']">Doit être >= 0</small>
      </div>
    </div>

    <div class="actions">
      <button type="submit">{{ isEditMode ? 'Mettre à jour' : 'Ajouter' }}</button>
      <button type="button" (click)="onCancel(bookForm)">Annuler</button>
    </div>
  </form>
</div>
